<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>PIXXART</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{font-family:Arial;background:#fff8f0;padding:10px}
h1{text-align:center;color:#c0392b}
h2{margin-top:15px}
select,input,button{width:100%;padding:8px;margin-top:5px}
.grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.product{background:#fff;padding:8px;border-radius:8px;text-align:center}
.product button{width:45%;font-size:18px}
.total{text-align:center;font-size:22px;font-weight:bold;margin-top:10px}
</style>
</head>

<body>

<h1>PIXXART üçïü•ü</h1>

<label>Tipo de venta</label>
<select id="tipoVenta" onchange="renderMenu();calcularTotal();">
  <option value="Local">Local</option>
  <option value="Delivery">Delivery</option>
  <option value="QR">QR</option>
</select>

<label>Descuento (Bs)</label>
<input type="number" id="descuento" value="0" oninput="calcularTotal()">

<h2>PIZZAS</h2>
<div class="grid" id="pizzas"></div>

<h2>EMPANADA</h2>
<div class="grid" id="empanada"></div>

<h2>BEBIDAS</h2>
<div class="grid">
  <div class="product"><b>Caf√©</b><br>Bs 4<br><button onclick="add('Caf√©',4)">+</button><button onclick="add('Caf√©',-4)">-</button></div>
  <div class="product"><b>Mate</b><br>Bs 4<br><button onclick="add('Mate',4)">+</button><button onclick="add('Mate',-4)">-</button></div>
  <div class="product"><b>Chocolate</b><br>Bs 5<br><button onclick="add('Chocolate',5)">+</button><button onclick="add('Chocolate',-5)">-</button></div>
</div>

<h2>REFRESCOS</h2>
<div class="grid">
  <div class="product"><b>300 ml</b><br>Bs 3.5<br><button onclick="add('Ref 300',3.5)">+</button><button onclick="add('Ref 300',-3.5)">-</button></div>
  <div class="product"><b>600 ml</b><br>Bs 6<br><button onclick="add('Ref 600',6)">+</button><button onclick="add('Ref 600',-6)">-</button></div>
  <div class="product"><b>1.5 L</b><br>Bs 9<br><button onclick="add('Ref 1.5',9)">+</button><button onclick="add('Ref 1.5',-9)">-</button></div>
  <div class="product"><b>Personal</b><br>Bs 2.5<br><button onclick="add('Ref Pers',2.5)">+</button><button onclick="add('Ref Pers',-2.5)">-</button></div>
</div>

<div class="total">
Subtotal: Bs <span id="subtotal">0.00</span><br>
TOTAL A PAGAR: Bs <span id="total">0.00</span>
</div>

<button onclick="guardarVenta()">üíæ GUARDAR VENTA</button>

<script>
const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbzMrAu-ABoFSrl_s5QTKPMWeg1edmgSkp1YbLgpWpB2ogR_pKIDl3I_B3MW-W6ryaIh3Q/exec";

let subtotal = 0;
let pedido = {};
let ticket = Date.now();

function renderMenu(){
  let tipo = document.getElementById("tipoVenta").value;
  let pizzas = document.getElementById("pizzas");
  let emp = document.getElementById("empanada");
  pizzas.innerHTML = "";
  emp.innerHTML = "";

  const pizzaData = [
    ["P-C","Peque√±a Carn√≠vora",19,19],
    ["P-H","Peque√±a Hawaiana",19,19],
    ["P-J","Peque√±a Jam√≥n",19,19],
    ["M-C","Mediana Carn√≠vora",37,49],
    ["M-H","Mediana Hawaiana",37,49],
    ["M-J","Mediana Jam√≥n",37,49],
    ["G-C","Grande Carn√≠vora",70,90],
    ["G-H","Grande Hawaiana",70,90],
    ["G-J","Grande Jam√≥n",70,90]
  ];

  pizzaData.forEach(p=>{
    if(tipo==="Delivery" && p[0].startsWith("P")) return;
    let precio = (tipo==="Delivery") ? p[3] : p[2];
    pizzas.innerHTML += `<div class="product"><b>${p[0]}</b><br>Bs ${precio}<br>
    <button onclick="add('${p[0]}',${precio})">+</button>
    <button onclick="add('${p[0]}',-${precio})">-</button></div>`;
  });

  let empPrecio = (tipo==="Delivery") ? 7 : 5;
  emp.innerHTML = `<div class="product"><b>Empanada</b><br>Bs ${empPrecio}<br>
  <button onclick="add('Empanada',${empPrecio})">+</button>
  <button onclick="add('Empanada',-${empPrecio})">-</button></div>`;
}

function add(prod,precio){
  subtotal += precio;
  if(subtotal<0) subtotal=0;
  pedido[prod]=(pedido[prod]||0)+(precio>0?1:-1);
  if(pedido[prod]<=0) delete pedido[prod];
  calcularTotal();
}

function calcularTotal(){
  let desc = Number(document.getElementById("descuento").value)||0;
  let total = subtotal - desc;
  if(total<0) total=0;
  document.getElementById("subtotal").innerText=subtotal.toFixed(2);
  document.getElementById("total").innerText=total.toFixed(2);
}

function guardarVenta(){
  fetch(URL_SCRIPT,{
    method:"POST",
    mode:"no-cors",
    body:JSON.stringify({
      fecha:new Date().toLocaleDateString(),
      hora:new Date().toLocaleTimeString(),
      ticket:ticket,
      tipoVenta:document.getElementById("tipoVenta").value,
      detalle:JSON.stringify(pedido),
      subtotal:subtotal,
      descuento:Number(document.getElementById("descuento").value)||0,
      total:subtotal-(Number(document.getElementById("descuento").value)||0)
    })
  }).then(()=>{
    alert("‚úÖ Venta guardada");
    location.reload();
  });
}

renderMenu();
</script>

</body>
</html>
