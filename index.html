<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>PIXXART</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:Arial;background:#fff8f0;padding:15px}
h1{text-align:center;color:#c0392b}
h2{margin-top:20px}
.product{display:flex;justify-content:space-between;background:#fff;padding:10px;margin-bottom:6px;border-radius:8px}
button{padding:6px 12px;font-size:18px}
.total{font-size:24px;font-weight:bold;text-align:center;margin-top:10px}
input,select{width:100%;padding:8px;margin-top:5px}
.ticket{font-family:monospace;font-size:14px}
</style>
</head>

<body>

<h1>PIXXART üçïü•ü</h1>

<label>Tipo de venta:</label>
<select id="tipoVenta">
  <option value="Local">Local</option>
  <option value="Delivery">Delivery</option>
  <option value="QR">QR</option>
</select>

<label>Descuento (Bs):</label>
<input type="number" id="descuento" value="0">

<h2>PIZZAS</h2>
<div class="product"><span>P-C</span><div><button onclick="add('P-C',19)">+</button><button onclick="add('P-C',-19)">-</button></div></div>
<div class="product"><span>P-H</span><div><button onclick="add('P-H',19)">+</button><button onclick="add('P-H',-19)">-</button></div></div>
<div class="product"><span>P-J</span><div><button onclick="add('P-J',19)">+</button><button onclick="add('P-J',-19)">-</button></div></div>
<div class="product"><span>M-C</span><div><button onclick="add('M-C',37)">+</button><button onclick="add('M-C',-37)">-</button></div></div>
<div class="product"><span>M-H</span><div><button onclick="add('M-H',37)">+</button><button onclick="add('M-H',-37)">-</button></div></div>
<div class="product"><span>M-J</span><div><button onclick="add('M-J',37)">+</button><button onclick="add('M-J',-37)">-</button></div></div>
<div class="product"><span>G-C</span><div><button onclick="add('G-C',70)">+</button><button onclick="add('G-C',-70)">-</button></div></div>
<div class="product"><span>G-H</span><div><button onclick="add('G-H',70)">+</button><button onclick="add('G-H',-70)">-</button></div></div>
<div class="product"><span>G-J</span><div><button onclick="add('G-J',70)">+</button><button onclick="add('G-J',-70)">-</button></div></div>

<div class="product"><span>Empanada</span><div><button onclick="add('Empanada',5)">+</button><button onclick="add('Empanada',-5)">-</button></div></div>

<div class="total">
Subtotal: Bs <span id="subtotal">0.00</span><br>
TOTAL A PAGAR: Bs <span id="total">0.00</span>
</div>

<button onclick="guardarVenta()">üíæ GUARDAR VENTA</button>

<script>
let subtotal = 0;
let pedido = {};
let ticket = Date.now();

const URL_SCRIPT = "https://script.google.com/macros/s/AKfycbzMrAu-ABoFSrl_s5QTKPMWeg1edmgSkp1YbLgpWpB2ogR_pKIDl3I_B3MW-W6ryaIh3Q/exec";

function add(prod, precio){
  subtotal += precio;
  if(subtotal < 0) subtotal = 0;

  pedido[prod] = (pedido[prod]||0)+(precio>0?1:-1);
  if(pedido[prod]<=0) delete pedido[prod];

  calcularTotal();
}

function calcularTotal(){
  let desc = Number(document.getElementById("descuento").value)||0;
  let total = subtotal - desc;
  if(total<0) total = 0;
  document.getElementById("subtotal").innerText = subtotal.toFixed(2);
  document.getElementById("total").innerText = total.toFixed(2);
}

function guardarVenta(){
  let data = {
    fecha: new Date().toLocaleDateString(),
    hora: new Date().toLocaleTimeString(),
    ticket: ticket,
    tipoVenta: document.getElementById("tipoVenta").value,
    detalle: JSON.stringify(pedido),
    subtotal: subtotal,
    descuento: Number(document.getElementById("descuento").value)||0,
    total: subtotal - (Number(document.getElementById("descuento").value)||0)
  };

  fetch(URL_SCRIPT,{
    method:"POST",
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(()=>{
    alert("‚úÖ Venta guardada correctamente");
    location.reload();
  })
  .catch(()=>alert("‚ùå Error al guardar"));
}
</script>

</body>
</html>
